
маркер ФункцияСостояния с записью
маркер СостояниеИРезультат с 2 записями

пусть запустить от ф от сост
    (ФункцияСостояния ф) сост
монада Состояние
    пусть `>>=` от м от ф
        ФункцияСостояния(от сост
            пусть СиР запустить м сост
            пусть новоеСостояние СостояниеИРезультат 0 СиР
            пусть Результат СостояниеИРезультат 1 СиР
            запустить (ф Результат) новоеСостояние
        )
    пусть упаковать от м
        ФункцияСостояния(от сост
            СостояниеИРезультат сост м
        )

пусть изменитьСостояние от ф
    ФункцияСостояния(от сост
        СостояниеИРезультат (ф сост) ()
    )

пусть получитьСостояние
    ФункцияСостояния(от сост
        СостояниеИРезультат сост сост
    )

пусть Рез
    применить Состояние
        изменитьСостояние((+)1)>>
        изменитьСостояние((*)2)>>
        получитьСостояние>>=
        (от рез
            вывести рез
            начало
        )
запустить Рез 1
